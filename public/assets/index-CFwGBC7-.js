import{f as c}from"./fetch-BiMQVL8a.js";const u=document.querySelector(".createuser");u.addEventListener("click",async t=>{t.preventDefault(),console.log("Nyt luodaan käyttäjä");const o="https://helmar.northeurope.cloudapp.azure.com/api/api/users",e=document.querySelector(".create_user_form"),a={username:e.querySelector("input[name=username]").value,password:e.querySelector("input[name=password]").value,email:e.querySelector("input[name=email]").value},n={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)};try{const s=await c(o,n);console.log(s)}catch(s){console.error(s)}});const i=document.querySelector(".loginuser");i.addEventListener("click",async t=>{t.preventDefault(),console.log("Nyt logataan sisään");const o="https://helmar.northeurope.cloudapp.azure.com/api/api/auth/login",e=document.querySelector(".login_form"),r={username:e.querySelector("input[name=username]").value,password:e.querySelector("input[name=password]").value},a={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)};c(o,a).then(n=>{console.log(n),console.log(n.token),localStorage.setItem("token",n.token),l("loginResponse",`localStorage set with token value: ${n.token}`),n.token==null?alert("Unauthorized: username or password incorrect!"):(alert("Authorized: you will now be redirected in 3 seconds"),setTimeout(function(){window.location.href="start-api-harjoituspohja.html"},3e3))})});const m=document.querySelector("#meRequest");m.addEventListener("click",async()=>{console.log("Testataan TOKENIA ja haetaan käyttäjän tiedot");const t="https://helmar.northeurope.cloudapp.azure.com/api/api/auth/me",o=localStorage.getItem("token");console.log("Tämä on haettu LocalStoragesta",o);const e={method:"GET",headers:{Authorization:"Bearer: "+o}};console.log(e),c(t,e).then(r=>{console.log(r),l("meResponse",`Authorized user info: ${JSON.stringify(r)}`)})});const p=document.querySelector("#clearButton");p.addEventListener("click",d);function l(t,o){document.getElementById(t).innerText=o}function d(){localStorage.removeItem("token"),l("clearResponse","localStorage cleared!")}
