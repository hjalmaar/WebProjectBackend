import{f as i}from"./fetch-ZGf-g78y.js";const y=document.querySelector(".get_entry");y.addEventListener("click",async()=>{console.log("Klikki toimii"),i("https://helmar.northeurope.cloudapp.azure.com/api/api/entries/1").then(n=>{console.log(n)})});const f=document.querySelector(".get_users");f.addEventListener("click",E);async function E(){console.log("Haetaa kaikki käyttäjät");const o="https://helmar.northeurope.cloudapp.azure.com/api/api/users",t={method:"GET",headers:{Authorization:"Bearer: "+localStorage.getItem("token")}};i(o,t).then(e=>{C(e)})}function k(o){o.preventDefault();let n=localStorage.getItem("token");const t={username:document.getElementById("username").value,password:document.getElementById("password").value,email:document.getElementById("email").value},e={method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${n}`},body:JSON.stringify(t)};i("https://helmar.northeurope.cloudapp.azure.com/api/api/users",e).then(l=>{console.log("User updated:",l),alert("User updated successfully!")}).catch(l=>{console.error("Error updating user:",l)})}const T=document.getElementById("updateUserForm");T.addEventListener("submit",k);function C(o){console.log(o);const n=document.querySelector(".tbody");n.innerHTML="",o.forEach(t=>{console.log(t.user_id,t.username,t.user_level);const e=document.createElement("tr"),s=document.createElement("td");s.innerText=t.username;const l=document.createElement("td");l.innerText=t.user_level;const a=document.createElement("td"),d=document.createElement("button");d.className="check",d.setAttribute("data-id",t.user_id),d.innerText="Info",a.appendChild(d),d.addEventListener("click",w);const u=document.createElement("td"),c=document.createElement("button");c.className="del",c.setAttribute("data-id",t.user_id),c.innerText="Delete",u.appendChild(c),c.addEventListener("click",D);var r=document.createElement("td");r.innerText=t.user_id,e.appendChild(s),e.appendChild(l),e.appendChild(a),e.appendChild(u),e.appendChild(r),n.appendChild(e)})}function w(){console.log("Haet tietoa")}document.addEventListener("DOMContentLoaded",()=>{const o=document.getElementById("addEntryForm");o?o.addEventListener("submit",function(n){n.preventDefault();const t="https://helmar.northeurope.cloudapp.azure.com/api/api/entries";let e=localStorage.getItem("token");if(!e){alert("No token found. Please log in.");return}const s={entry_date:document.getElementById("entry_date").value,mood:document.getElementById("mood").value,weight:parseFloat(document.getElementById("weight").value),sleep_hours:parseFloat(document.getElementById("sleep_hours").value),notes:document.getElementById("notes").value};console.log("Sending entry data:",s);const l={method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify(s)};fetch(t,l).then(a=>{if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);return a.json()}).then(a=>{console.log("Entry added:",a),alert("Entry added successfully!")}).catch(a=>{console.error("Error adding entry:",a),alert("Failed to add entry. Please check the console for more information.")})}):console.error("Form not found on the page.")});function b(o){if(confirm("Are you sure you want to delete this entry?")){const n=`https://helmar.northeurope.cloudapp.azure.com/api/api/entries/${o}`,e={method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`}};i(n,e).then(()=>{console.log(`Entry ${o} deleted`),m()}).catch(s=>{console.error("Error deleting entry:",s)})}}function m(){const o="https://helmar.northeurope.cloudapp.azure.com/api/api/entries",t={method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`}};i(o,t).then(e=>{console.log("Entries:",e),B(e)}).catch(e=>{console.error("Error fetching entries:",e)})}document.addEventListener("DOMContentLoaded",()=>{m()});function B(o){const n=document.querySelector(".entries-tbody");n.innerHTML="",o.forEach(t=>{const e=document.createElement("tr"),s=document.createElement("td");s.innerText=t.entry_date;const l=document.createElement("td");l.innerText=t.mood;const a=document.createElement("td");a.innerText=t.weight;const d=document.createElement("td");d.innerText=t.sleep_hours;const u=document.createElement("td");u.innerText=t.notes;const c=document.createElement("td"),r=document.createElement("button");r.textContent="Edit",r.onclick=()=>S(t.entry_id),c.appendChild(r);const h=document.createElement("td"),p=document.createElement("button");p.textContent="Delete",p.onclick=()=>b(t.entry_id),h.appendChild(p),e.appendChild(s),e.appendChild(l),e.appendChild(a),e.appendChild(d),e.appendChild(u),e.appendChild(c),e.appendChild(h),n.appendChild(e)})}function S(o){const n=prompt("Enter the new entry date (YYYY-MM-DD):",""),t=prompt("Enter the new mood:",""),e=prompt("Enter the new weight:",""),s=prompt("Enter the new sleep hours:",""),l=prompt("Enter the new notes:",""),a={entry_date:n,mood:t,weight:parseFloat(e),sleep_hours:parseFloat(s),notes:l},d=`https://helmar.northeurope.cloudapp.azure.com/api/api/entries/${o}`,c={method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify(a)};i(d,c).then(r=>{if(!r.ok)throw new Error("Error updating the entry");return r.json()}).then(r=>{console.log("Entry updated:",r),alert("Entry updated successfully!"),m()}).catch(r=>{r.response?(console.log(r.response.data),console.log(r.response.status),console.log(r.response.headers)):r.request?console.log(r.request):console.log("Error",r.message),alert("Failed to update entry. Check console for more information.")})}function I(){localStorage.removeItem("token"),window.location.href="/index"}const g=document.querySelector(".logout a");g?g.addEventListener("click",function(o){o.preventDefault(),I()}):console.error("Logout link not found. Make sure the class is correct and the DOM is fully loaded.");function D(o){console.log("Deletoit tietoa"),console.log(o);const n=o.target.attributes["data-id"].value;console.log(n);const t=o.target.parentElement.nextElementSibling.textContent;console.log("Toinen tapa: ",t);const e=`https://helmar.northeurope.cloudapp.azure.com/api/api/users/${n}`,l={method:"DELETE",headers:{Authorization:"Bearer: "+localStorage.getItem("token")}};confirm(`Oletko varma että haluat poistaa käyttäjän ID: ${n} `)&&i(e,l).then(d=>{console.log(d),E()})}async function L(){console.log("Hei täällä ollaan! Nyt pitäisi hakea käyttäjän tiedot");const o="https://helmar.northeurope.cloudapp.azure.com/api/api/auth/me",t={method:"GET",headers:{Authorization:"Bearer: "+localStorage.getItem("token")}};i(o,t).then(e=>{console.log(e),document.getElementById("name").innerHTML=e.user.username})}L();
