import{f as i}from"./fetch-BiMQVL8a.js";const y=document.querySelector(".get_users");y.addEventListener("click",f);async function f(){console.log("Haetaa kaikki käyttäjät");const n="https://helmar.northeurope.cloudapp.azure.com/api/api/users",e={method:"GET",headers:{Authorization:"Bearer: "+localStorage.getItem("token")}};i(n,e).then(t=>{T(t)})}function k(n){n.preventDefault();let o=localStorage.getItem("token");const e={username:document.getElementById("username").value,password:document.getElementById("password").value,email:document.getElementById("email").value},t={method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`},body:JSON.stringify(e)};i("https://helmar.northeurope.cloudapp.azure.com/api/api/users",t).then(d=>{console.log("User updated:",d),alert("User updated successfully!")}).catch(d=>{console.error("Error updating user:",d)})}const w=document.getElementById("updateUserForm");w.addEventListener("submit",k);function T(n){console.log(n);const o=document.querySelector(".tbody");o.innerHTML="",n.forEach(e=>{console.log(e.user_id,e.username,e.user_level);const t=document.createElement("tr"),a=document.createElement("td");a.innerText=e.username;const d=document.createElement("td");d.innerText=e.user_level;const r=document.createElement("td"),l=document.createElement("button");l.className="check",l.setAttribute("data-id",e.user_id),l.innerText="Info",r.appendChild(l),l.addEventListener("click",b);const u=document.createElement("td"),s=document.createElement("button");s.className="del",s.setAttribute("data-id",e.user_id),s.innerText="Delete",u.appendChild(s),s.addEventListener("click",_);var c=document.createElement("td");c.innerText=e.user_id,t.appendChild(a),t.appendChild(d),t.appendChild(r),t.appendChild(u),t.appendChild(c),o.appendChild(t)})}function b(){console.log("Haet tietoa")}document.addEventListener("DOMContentLoaded",()=>{const n=document.getElementById("addEntryForm");n?n.addEventListener("submit",function(o){o.preventDefault();const e="https://helmar.northeurope.cloudapp.azure.com/api/api/entries";let t=localStorage.getItem("token");if(!t){alert("No token found. Please log in.");return}const a={entry_date:document.getElementById("entry_date").value,mood:document.getElementById("mood").value,weight:parseFloat(document.getElementById("weight").value),sleep_hours:parseFloat(document.getElementById("sleep_hours").value),notes:document.getElementById("notes").value};console.log("Sending entry data:",a);const d={method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify(a)};fetch(e,d).then(r=>{if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);return r.json()}).then(r=>{console.log("Entry added:",r),alert("Entry added successfully!")}).catch(r=>{console.error("Error adding entry:",r),alert("Failed to add entry. Please check the console for more information.")})}):console.error("Form not found on the page.")});function S(n){if(confirm("Are you sure you want to delete this entry?")){const o=`https://helmar.northeurope.cloudapp.azure.com/api/api/entries/${n}`,t={method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`}};i(o,t).then(()=>{console.log(`Entry ${n} deleted`),h()}).catch(a=>{console.error("Error deleting entry:",a)})}}document.addEventListener("DOMContentLoaded",()=>{const n=document.getElementById("medicationForm");n?n.addEventListener("submit",function(o){o.preventDefault();const e="https://helmar.northeurope.cloudapp.azure.com/api/api/medications";let t=localStorage.getItem("token");if(!t){alert("No token found. Please log in.");return}const a={name:document.getElementById("med_name").value,dosage:document.getElementById("dosage").value,frequency:document.getElementById("frequency").value,start_date:document.getElementById("start_date").value,end_date:document.getElementById("end_date").value};console.log("Sending medication data:",a);const d={method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify(a)};fetch(e,d).then(r=>{if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);return r.json()}).then(r=>{console.log("Medication added:",r),alert("Medication added successfully!")}).catch(r=>{console.error("Error adding medication:",r),alert("Failed to add medication. Please check the console for more information.")})}):console.error("Medication form not found on the page.")});function p(){const n=localStorage.getItem("token");if(!n){console.error("No token found in localStorage.");return}fetch("https://helmar.northeurope.cloudapp.azure.com/api/api/medications",{headers:{Authorization:`Bearer ${n}`}}).then(o=>{if(!o.ok)throw new Error(`Network response was not ok (status: ${o.status})`);return o.json()}).then(o=>{console.log(o),C(o)}).catch(o=>{console.error("Error:",o)})}document.addEventListener("DOMContentLoaded",n=>{p()});function C(n){const o=document.querySelector(".medications-tbody");o.innerHTML="",n.forEach(e=>{const t=document.createElement("tr");t.innerHTML=`
      <td>${e.name}</td>
      <td>${e.dosage}</td>
      <td>${e.frequency}</td>
      <td>${new Date(e.start_date).toLocaleDateString()}</td>
      <td>${new Date(e.end_date).toLocaleDateString()}</td>
      <td>
        <button class="edit-btn" data-id="${e.medication_id}">Edit</button>
        <button class="delete-btn" data-id="${e.medication_id}">Delete</button>
      </td>
    `,o.appendChild(t)}),o.querySelectorAll(".edit-btn").forEach(e=>{e.addEventListener("click",t=>{const a=t.target.getAttribute("data-id");B(a)})}),o.querySelectorAll(".delete-btn").forEach(e=>{e.addEventListener("click",t=>{const a=t.target.getAttribute("data-id");D(a)})})}function B(n){const o=prompt("Enter new medication name:"),e=prompt("Enter new dosage:"),t=prompt("Enter new frequency:");if(o&&e&&t){const a={medication_id:n,name:o,dosage:e,frequency:t},d=localStorage.getItem("token");fetch(`https://helmar.northeurope.cloudapp.azure.com/api/api/medications/${n}`,{method:"PUT",headers:{Authorization:`Bearer ${d}`,"Content-Type":"application/json"},body:JSON.stringify(a)}).then(r=>{if(!r.ok)throw new Error("Failed to update medication.");return r.json()}).then(r=>{console.log("Medication updated:",r),p()}).catch(r=>{console.error("Error updating medication:",r)})}else console.log("Medication update cancelled.")}function D(n){const o=localStorage.getItem("token");if(!o){alert("No token found. Please log in.");return}confirm("Are you sure you want to delete this medication?")&&fetch(`https://helmar.northeurope.cloudapp.azure.com/api/api/medications/${n}`,{method:"DELETE",headers:{Authorization:`Bearer ${o}`}}).then(e=>{if(!e.ok)throw new Error(`Network response was not ok (status: ${e.status})`);p()}).catch(e=>{console.error("Error deleting medication:",e)})}function h(){const n="https://helmar.northeurope.cloudapp.azure.com/api/api/entries",e={method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`}};i(n,e).then(t=>{console.log("Entries:",t),I(t)}).catch(t=>{console.error("Error fetching entries:",t)})}document.addEventListener("DOMContentLoaded",()=>{h()});function I(n){const o=document.querySelector(".entries-tbody");o.innerHTML="",n.forEach(e=>{const t=document.createElement("tr"),a=document.createElement("td");a.innerText=e.entry_date;const d=document.createElement("td");d.innerText=e.mood;const r=document.createElement("td");r.innerText=e.weight;const l=document.createElement("td");l.innerText=e.sleep_hours;const u=document.createElement("td");u.innerText=e.notes;const s=document.createElement("td"),c=document.createElement("button");c.textContent="Edit",c.onclick=()=>L(e.entry_id),s.appendChild(c);const g=document.createElement("td"),m=document.createElement("button");m.textContent="Delete",m.onclick=()=>S(e.entry_id),g.appendChild(m),t.appendChild(a),t.appendChild(d),t.appendChild(r),t.appendChild(l),t.appendChild(u),t.appendChild(s),t.appendChild(g),o.appendChild(t)})}function L(n){const o=prompt("Enter the new entry date (YYYY-MM-DD):",""),e=prompt("Enter the new mood:",""),t=prompt("Enter the new weight:",""),a=prompt("Enter the new sleep hours:",""),d=prompt("Enter the new notes:",""),r={entry_date:o,mood:e,weight:parseFloat(t),sleep_hours:parseFloat(a),notes:d},l=`https://helmar.northeurope.cloudapp.azure.com/api/api/entries/${n}`,s={method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify(r)};i(l,s).then(c=>{if(!c.ok)throw new Error("Error updating the entry");return c.json()}).then(c=>{console.log("Entry updated:",c),alert("Entry updated successfully!"),h()}).catch(c=>{c.response?(console.log(c.response.data),console.log(c.response.status),console.log(c.response.headers)):c.request?console.log(c.request):console.log("Error",c.message),alert("Failed to update entry. Check console for more information.")})}function v(){localStorage.removeItem("token"),window.location.href="/index"}const E=document.querySelector(".logout a");E?E.addEventListener("click",function(n){n.preventDefault(),v()}):console.error("Logout link not found. Make sure the class is correct and the DOM is fully loaded.");function _(n){console.log("Deletoit tietoa"),console.log(n);const o=n.target.attributes["data-id"].value;console.log(o);const e=n.target.parentElement.nextElementSibling.textContent;console.log("Toinen tapa: ",e);const t=`https://helmar.northeurope.cloudapp.azure.com/api/api/users/${o}`,d={method:"DELETE",headers:{Authorization:"Bearer: "+localStorage.getItem("token")}};confirm(`Oletko varma että haluat poistaa käyttäjän ID: ${o} `)&&i(t,d).then(l=>{console.log(l),f()})}async function $(){console.log("Hei täällä ollaan! Nyt pitäisi hakea käyttäjän tiedot");const n="https://helmar.northeurope.cloudapp.azure.com/api/api/auth/me",e={method:"GET",headers:{Authorization:"Bearer: "+localStorage.getItem("token")}};i(n,e).then(t=>{console.log(t),document.getElementById("name").innerHTML=t.user.username})}$();
